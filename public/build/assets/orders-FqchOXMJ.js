import{r as a,f as H,j as e,H as Z,L as S,a as C}from"./app-y1ZB5c9x.js";import{B as O}from"./badge-YGhNNr7I.js";import{B as r}from"./button-CX5HfBYh.js";import{I as P}from"./input-j8Hg-lNY.js";import{L as x}from"./label-Ccpzj8oe.js";import{A as ee}from"./app-layout-uPNE-LV-.js";import{F as h,a as _,b as W,s as se,e as u,t as te,u as ae,r as re,o as ne,v as le}from"./index-dbElndna.js";/* empty css            */import"./index-gDNE8eHE.js";import"./app-shell-BjHxV_At.js";import"./index-Gy2IxKx_.js";import"./createLucideIcon-BeSqJyBR.js";import"./index-BOy9vQFC.js";import"./iconBase-CV3Sr50B.js";import"./app-logo-Cvmxpj7m.js";import"./index-CqpU3lQc.js";const ie=[{title:"My Portfolio",href:"/orders"}],D={pending:{color:"bg-yellow-500/10 text-yellow-700 border-yellow-200",icon:W,label:"Pending"},completed:{color:"bg-green-500/10 text-green-700 border-green-200",icon:h,label:"Completed"},cancelled:{color:"bg-red-500/10 text-red-700 border-red-200",icon:_,label:"Cancelled"},failed:{color:"bg-red-500/10 text-red-700 border-red-200",icon:_,label:"Failed"},sent:{color:"bg-blue-500/10 text-blue-700 border-blue-200",icon:h,label:"Sent (P2P)"}},de=["TRC20","ERC20","BEP20","Polygon","Solana","Bitcoin"];function Ce({orders:d,paymentMethods:Y}){const[v,F]=a.useState(!1),[n,A]=a.useState(null),[t,o]=a.useState(1),[p,T]=a.useState(""),[f,L]=a.useState(""),[g,E]=a.useState(""),[oe,G]=a.useState(""),[j,M]=a.useState(""),[z,B]=a.useState(""),[y,w]=a.useState(!1),[i,R]=a.useState(null),[c,m]=a.useState("pending"),[U,b]=a.useState(!1),[N,I]=a.useState("");a.useEffect(()=>{let s;return v&&i&&t===3&&(s=setInterval(async()=>{try{const l=await H.get(`/api/p2p-transfer/${i}/status`);l.data.status!==c&&m(l.data.status)}catch(l){console.error("Error polling status:",l)}},2e3)),()=>{s&&clearInterval(s)}},[v,i,t,c]);const $=s=>{C.patch(`/admin/orders/${s}/status`,{status:"sent"},{onSuccess:()=>{k()}})},X=s=>{A(s),F(!0),o(1),T(""),L(""),E(s.total_price),G(""),M(""),B(""),w(!1),R(null),m("pending"),b(!1),I("")},k=()=>{F(!1),A(null),o(1)},q=async()=>{if(t===1&&p&&f)o(2);else if(t===2&&g&&j&&n)try{const s=await H.post("/api/p2p-transfer/create",{order_id:n.id,partner_address:p,partner_payment_method_id:f,amount:g,sender_address:"",network:j});s.data.success&&(B(s.data.link),R(s.data.transfer_id),m("pending"),o(3))}catch(s){console.error("Error creating P2P transfer:",s)}},J=()=>{i&&C.post(`/p2p-transfer/${i}/release`,{},{onSuccess:()=>{m("released")}})},K=()=>{!i||!N||C.post(`/p2p-transfer/${i}/appeal`,{reason:N},{onSuccess:()=>{m("appealed"),b(!1)}})},Q=()=>{navigator.clipboard.writeText(z),w(!0),setTimeout(()=>w(!1),2e3)};return e.jsxs(ee,{breadcrumbs:ie,children:[e.jsx(Z,{title:"My Portfolio"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-4",children:[e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"My Portfolio"}),d.length>0&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[d.length," NFT",d.length!==1?"s":""]})]}),e.jsx(S,{href:"/nft-marketplace",children:e.jsx(r,{size:"sm",variant:"outline",children:"Browse NFTs"})})]}),d.length>0?e.jsx("div",{className:"space-y-2",children:d.map(s=>{const l=D[s.status]||D.pending,V=l.icon;return e.jsxs("div",{className:"group border border-border bg-card rounded-xl overflow-hidden hover:shadow-lg hover:border-foreground/20 transition-all duration-200",children:[e.jsx(S,{href:`/orders/${s.id}`,children:e.jsx("div",{className:"cursor-pointer",children:e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[s.nft_image&&e.jsx("div",{className:"relative flex-shrink-0",children:e.jsx("img",{src:s.nft_image,alt:s.nft_name,className:"w-20 h-20 rounded-lg object-cover border border-border"})}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"text-base font-semibold text-foreground truncate mb-1",children:s.nft_name}),e.jsx("p",{className:"text-xs text-muted-foreground font-mono",children:s.order_number})]}),e.jsxs(O,{className:`${l.color} flex items-center gap-1.5 whitespace-nowrap`,children:[e.jsx(V,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"text-xs font-medium",children:l.label})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Amount"}),e.jsxs("p",{className:"font-semibold text-foreground",children:[s.total_price," ETH"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Payment"}),e.jsx("p",{className:"font-medium text-foreground capitalize",children:s.payment_method})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(W,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:s.created_at_diff})]})]})]})})})}),s.status==="completed"&&e.jsxs("div",{className:"px-4 pb-4 flex gap-2 justify-end border-t border-border pt-3",children:[e.jsxs(r,{size:"sm",variant:"outline",className:"h-8 text-xs gap-1.5 px-3",onClick:()=>X(s),children:[e.jsx(se,{className:"w-3 h-3"}),"P2P Sent"]}),e.jsxs(r,{size:"sm",className:"h-8 text-xs gap-1.5 px-3",onClick:()=>$(s.id),children:[e.jsx(u,{className:"w-3 h-3"}),"Sent"]})]})]},s.id)})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx(te,{className:"w-10 h-10 text-muted-foreground mb-3"}),e.jsx("h3",{className:"font-medium text-foreground mb-1",children:"No orders yet"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"Start exploring to buy your first NFT"}),e.jsx(S,{href:"/nft-marketplace",children:e.jsx(r,{size:"sm",children:"Browse NFTs"})})]}),v&&n&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-md flex items-center justify-center z-50 p-4 animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-background border border-border rounded-2xl shadow-2xl max-w-lg w-full max-h-[90vh] overflow-hidden flex flex-col animate-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"border-b border-border px-6 py-5 bg-muted/30",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-foreground tracking-tight",children:"P2P Send NFT"}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1 font-medium uppercase tracking-wider",children:["Step ",t," of 3"]})]}),e.jsx("button",{onClick:k,className:"h-8 w-8 rounded-full flex items-center justify-center hover:bg-muted transition-colors text-muted-foreground hover:text-foreground",children:e.jsx(_,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"mt-5 flex gap-2",children:[1,2,3].map(s=>e.jsx("div",{className:`h-1.5 flex-1 rounded-full transition-all duration-500 ${s<=t?"bg-primary":"bg-muted"}`},s))})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[e.jsx("div",{className:"px-6 pt-6",children:e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-muted/30 rounded-xl border border-border/50",children:[n.nft_image&&e.jsx("img",{src:n.nft_image,alt:n.nft_name,className:"w-16 h-16 rounded-xl object-cover border border-border/50 shadow-sm flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-base font-semibold text-foreground truncate",children:n.nft_name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs(O,{variant:"secondary",className:"text-xs font-normal bg-background border-border/50",children:[n.total_price," ETH"]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["#",n.order_number]})]})]})]})}),t===1&&e.jsxs("div",{className:"px-6 py-6 space-y-6 animate-in slide-in-from-right-4 duration-300",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-1",children:"Partner's Payment Details"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter the destination details for this transfer."})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{htmlFor:"partner-address",className:"text-sm font-medium",children:["NFT Payment Address ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(P,{id:"partner-address",placeholder:"0x...",value:p,onChange:s=>T(s.target.value),className:"h-11 font-mono text-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{htmlFor:"partner-method",className:"text-sm font-medium",children:["Payment Method ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{id:"partner-method",value:f,onChange:s=>L(s.target.value),className:"w-full h-11 px-3 rounded-md border border-input bg-background text-sm appearance-none focus:ring-2 focus:ring-primary/20 focus:border-primary transition-all",children:[e.jsx("option",{value:"",children:"Select payment method"}),Y.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-muted-foreground",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"m6 9 6 6 6-6"})})})]})]})]})]}),t===2&&e.jsxs("div",{className:"px-6 py-6 space-y-6 animate-in slide-in-from-right-4 duration-300",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-1",children:"Transfer Details"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Confirm the amount and network for this transaction."})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{htmlFor:"your-amount",className:"text-sm font-medium",children:["Amount (ETH) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(P,{id:"your-amount",type:"number",step:"0.01",placeholder:"0.00",value:g,onChange:s=>E(s.target.value),className:"h-11 font-mono text-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{htmlFor:"your-network",className:"text-sm font-medium",children:["Network ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{id:"your-network",value:j,onChange:s=>M(s.target.value),className:"w-full h-11 px-3 rounded-md border border-input bg-background text-sm appearance-none focus:ring-2 focus:ring-primary/20 focus:border-primary transition-all",children:[e.jsx("option",{value:"",children:"Select network"}),de.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-muted-foreground",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"m6 9 6 6 6-6"})})})]})]})]})]}),t===3&&e.jsxs("div",{className:"px-6 py-8 space-y-6 animate-in slide-in-from-right-4 duration-300",children:[c==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-20 h-20 bg-green-500/10 rounded-full flex items-center justify-center mx-auto ring-8 ring-green-500/5",children:e.jsx(u,{className:"w-10 h-10 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-foreground",children:"Link Generated!"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Waiting for partner to complete payment..."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-5 bg-muted/30 rounded-xl border border-border/50 group relative",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2 uppercase tracking-wider",children:"Transfer Link"}),e.jsx("p",{className:"text-sm font-mono text-foreground break-all pr-8",children:z})]}),e.jsxs(r,{onClick:Q,variant:y?"default":"outline",className:"w-full h-12 gap-2 transition-all duration-300",children:[y?e.jsx(u,{className:"w-5 h-5"}):e.jsx(ae,{className:"w-5 h-5"}),y?"Copied to Clipboard":"Copy Secure Link"]})]}),e.jsxs("div",{className:"bg-blue-500/5 border border-blue-500/10 rounded-xl p-4 flex gap-3 items-start",children:[e.jsx("div",{className:"mt-0.5 text-blue-600",children:e.jsx("div",{className:"animate-pulse w-2 h-2 rounded-full bg-blue-600"})}),e.jsx("p",{className:"text-sm text-blue-600/90 leading-relaxed",children:"Share this link with your partner. This window will update automatically when they complete the payment."})]})]}),c==="payment_completed"&&e.jsxs("div",{className:"space-y-6 animate-in zoom-in-95 duration-300",children:[e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-20 h-20 bg-green-500/10 rounded-full flex items-center justify-center mx-auto ring-8 ring-green-500/5",children:e.jsx(h,{className:"w-10 h-10 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-foreground",children:"Payment Received!"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Partner has marked the payment as completed."})]})]}),e.jsxs("div",{className:"bg-muted/30 rounded-xl border border-border/50 p-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Amount"}),e.jsxs("span",{className:"font-medium",children:[n.total_price," ETH"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Status"}),e.jsxs("span",{className:"text-green-600 font-medium flex items-center gap-1",children:[e.jsx(h,{className:"w-3 h-3"})," Completed"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(r,{onClick:J,className:"h-12 gap-2",variant:"default",children:[e.jsx(u,{className:"w-5 h-5"}),"Release Now"]}),e.jsxs(r,{onClick:()=>b(!0),variant:"outline",className:"h-12 gap-2 border-red-200 text-red-600 hover:bg-red-50 hover:text-red-700",children:[e.jsx(re,{className:"w-5 h-5"}),"Appeal"]})]}),U&&e.jsxs("div",{className:"space-y-3 pt-2 animate-in slide-in-from-top-2",children:[e.jsx(x,{children:"Reason for Appeal"}),e.jsx(P,{value:N,onChange:s=>I(s.target.value),placeholder:"Describe the issue..."}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(r,{size:"sm",variant:"ghost",onClick:()=>b(!1),children:"Cancel"}),e.jsx(r,{size:"sm",variant:"destructive",onClick:K,disabled:!N,children:"Submit Appeal"})]})]})]}),c==="released"&&e.jsxs("div",{className:"text-center space-y-4 animate-in zoom-in-95 duration-300",children:[e.jsx("div",{className:"w-20 h-20 bg-green-500/10 rounded-full flex items-center justify-center mx-auto ring-8 ring-green-500/5",children:e.jsx(h,{className:"w-10 h-10 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-foreground",children:"Transfer Complete!"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Asset has been released to the partner."})]}),e.jsx(r,{onClick:k,className:"w-full",children:"Close"})]})]})]}),e.jsxs("div",{className:"border-t border-border px-6 py-5 bg-muted/30 flex gap-3 sticky bottom-0",children:[t>1&&t<3&&e.jsxs(r,{variant:"outline",onClick:()=>o(t-1),className:"h-11 px-6 gap-2 hover:bg-background",children:[e.jsx(ne,{className:"w-4 h-4"}),"Back"]}),t<3?e.jsxs(r,{onClick:q,disabled:t===1&&(!p||!f)||t===2&&(!g||!j),className:"flex-1 h-11 gap-2 text-base font-medium shadow-lg shadow-primary/20",children:["Next Step",e.jsx(le,{className:"w-4 h-4"})]}):e.jsxs(r,{onClick:()=>$(n.id),className:"flex-1 h-11 gap-2 text-base font-medium",variant:"default",children:[e.jsx(u,{className:"w-4 h-4"}),"Mark as Sent"]})]})]})})]})]})}export{Ce as default};
