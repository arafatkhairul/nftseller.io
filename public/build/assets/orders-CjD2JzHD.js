import{r as t,f as U,j as e,H as xe,L as M,a as k}from"./app-BQ8RvNwM.js";import{B as X}from"./badge-FmMdDyUu.js";import{B as r}from"./button-C8BckL50.js";import{I as L}from"./input-Db2jNf8K.js";import{L as i}from"./label-_83rjlaJ.js";import{T as ue}from"./textarea-BgZ6o7bF.js";import{A as pe}from"./app-layout-WRPK3110.js";import{a as o,b as E,F as c,s as z,t as he,e as h,u as J,v as fe,q as ge,w as je}from"./index-BYMVUYZf.js";/* empty css            */import"./app-shell-DHwS8VWN.js";import"./index-o_6rpDzu.js";import"./createLucideIcon-Dtt6dnGg.js";import"./index-B8U4Ab98.js";import"./iconBase-LFWoVKCq.js";import"./app-logo-CMwlKwqR.js";import"./index-CqpU3lQc.js";const be=[{title:"My Portfolio",href:"/orders"}],K={pending:{color:"bg-yellow-500/10 text-yellow-700 border-yellow-200",icon:E,label:"Pending"},completed:{color:"bg-green-500/10 text-green-700 border-green-200",icon:c,label:"Completed"},cancelled:{color:"bg-red-500/10 text-red-700 border-red-200",icon:o,label:"Cancelled"},failed:{color:"bg-red-500/10 text-red-700 border-red-200",icon:o,label:"Failed"},sent:{color:"bg-blue-500/10 text-blue-700 border-blue-200",icon:c,label:"Sent"},appealed:{color:"bg-orange-500/10 text-orange-700 border-orange-200",icon:z,label:"Appealed"},appeal_approved:{color:"bg-green-500/10 text-green-700 border-green-200",icon:c,label:"Approved"},appeal_rejected:{color:"bg-red-900/10 text-red-900 border-red-500/50",icon:o,label:"Restricted"},pending_sent:{color:"bg-purple-500/10 text-purple-700 border-purple-200",icon:E,label:"Pending Verification"},sent_rejected:{color:"bg-red-500/10 text-red-700 border-red-200",icon:o,label:"Sent Rejected"}},Ne=["TRC20","ERC20","BEP20","Polygon","Solana","Bitcoin"];function Ie({orders:m,paymentMethods:Q}){const[S,B]=t.useState(!1),[n,R]=t.useState(null),[a,x]=t.useState(1),[f,I]=t.useState(""),[g,O]=t.useState(""),[j,$]=t.useState(""),[ve,Z]=t.useState(""),[b,H]=t.useState(""),[D,V]=t.useState(""),[C,_]=t.useState(!1),[d,Y]=t.useState(null),[u,p]=t.useState("pending"),[ee,N]=t.useState(!1),[v,W]=t.useState(""),[se,q]=t.useState(!1),[P,G]=t.useState(null),[y,F]=t.useState(""),[te,w]=t.useState(!1);t.useEffect(()=>{let s;return S&&d&&a===3&&(s=setInterval(async()=>{try{const l=await U.get(`/api/p2p-transfer/${d}/status`);l.data.status!==u&&p(l.data.status)}catch(l){console.error("Error polling status:",l)}},2e3)),()=>{s&&clearInterval(s)}},[S,d,a,u]);const ae=s=>{k.patch(`/admin/orders/${s}/status`,{status:"sent"},{onSuccess:()=>{A()}})},re=s=>{R(s),B(!0),x(1),I(""),O(""),$(s.total_price),Z(""),H(""),V(""),_(!1),Y(null),p("pending"),N(!1),W("")},A=()=>{B(!1),R(null),x(1)},ne=s=>{G(s),F(""),w(!1),q(!0)},T=()=>{q(!1),G(null),F(""),w(!1)},le=()=>{!P||!y||(w(!0),setTimeout(()=>{k.post(route("orders.sent-request",P.id),{sender_address:y},{onSuccess:()=>{T()},onError:()=>{w(!1)}})},3e3))},de=async()=>{if(a===1&&f&&g)x(2);else if(a===2&&j&&b&&n)try{const s=await U.post("/api/p2p-transfer/create",{order_id:n.id,partner_address:f,partner_payment_method_id:g,amount:j,sender_address:"",network:b});s.data.success&&(V(s.data.link),Y(s.data.transfer_id),p("pending"),x(3))}catch(s){console.error("Error creating P2P transfer:",s)}},ie=()=>{d&&k.post(`/p2p-transfer/${d}/release`,{},{onSuccess:()=>{p("released")}})},oe=()=>{!d||!v||k.post(`/p2p-transfer/${d}/appeal`,{reason:v},{onSuccess:()=>{p("appealed"),N(!1)}})},ce=()=>{navigator.clipboard.writeText(D),_(!0),setTimeout(()=>_(!1),2e3)};return e.jsxs(pe,{breadcrumbs:be,children:[e.jsx(xe,{title:"My Portfolio"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-4",children:[e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"My Portfolio"}),m.length>0&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[m.length," NFT",m.length!==1?"s":""]})]}),e.jsx(M,{href:"/nft-marketplace",children:e.jsx(r,{size:"sm",variant:"outline",children:"Browse NFTs"})})]}),m.length>0?e.jsx("div",{className:"space-y-2",children:m.map(s=>{const l=K[s.status]||K.pending,me=l.icon;return e.jsxs("div",{className:`group border border-border bg-card rounded-xl overflow-hidden hover:shadow-lg hover:border-foreground/20 transition-all duration-200 ${s.status==="appeal_rejected"?"opacity-75 grayscale-[0.5]":""}`,children:[e.jsx(M,{href:`/orders/${s.id}`,children:e.jsx("div",{className:"cursor-pointer",children:e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[s.nft_image&&e.jsx("div",{className:"relative flex-shrink-0",children:e.jsx("img",{src:s.nft_image,alt:s.nft_name,className:"w-20 h-20 rounded-lg object-cover border border-border"})}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"text-base font-semibold text-foreground truncate mb-1",children:s.nft_name}),e.jsx("p",{className:"text-xs text-muted-foreground font-mono",children:s.order_number})]}),e.jsxs(X,{className:`${l.color} flex items-center gap-1.5 whitespace-nowrap`,children:[e.jsx(me,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"text-xs font-medium",children:l.label})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Amount"}),e.jsxs("p",{className:"font-semibold text-foreground",children:[s.total_price," ETH"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Payment"}),e.jsx("p",{className:"font-medium text-foreground capitalize",children:s.payment_method})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(E,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:s.created_at_diff})]})]})]})})})}),(s.status==="completed"||s.status==="appeal_approved")&&e.jsxs("div",{className:"px-4 pb-4 flex gap-2 justify-end border-t border-border pt-3",children:[e.jsxs(r,{size:"sm",variant:"outline",className:"h-8 text-xs gap-1.5 px-3",onClick:()=>re(s),children:[e.jsx(he,{className:"w-3 h-3"}),"P2P Sent"]}),e.jsxs(r,{size:"sm",className:"h-8 text-xs gap-1.5 px-3",onClick:()=>ne(s),children:[e.jsx(h,{className:"w-3 h-3"}),"Sent"]})]})]},s.id)})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx(J,{className:"w-10 h-10 text-muted-foreground mb-3"}),e.jsx("h3",{className:"font-medium text-foreground mb-1",children:"No orders yet"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"Start exploring to buy your first NFT"}),e.jsx(M,{href:"/nft-marketplace",children:e.jsx(r,{size:"sm",children:"Browse NFTs"})})]}),S&&n&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-md flex items-center justify-center z-50 p-4 animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-background border border-border rounded-2xl shadow-2xl max-w-lg w-full max-h-[90vh] overflow-hidden flex flex-col animate-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"border-b border-border px-6 py-5 bg-muted/30",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-foreground tracking-tight",children:"P2P Send NFT"}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1 font-medium uppercase tracking-wider",children:["Step ",a," of 3"]})]}),e.jsx("button",{onClick:A,className:"h-8 w-8 rounded-full flex items-center justify-center hover:bg-muted transition-colors text-muted-foreground hover:text-foreground",children:e.jsx(o,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"mt-5 flex gap-2",children:[1,2,3].map(s=>e.jsx("div",{className:`h-1.5 flex-1 rounded-full transition-all duration-500 ${s<=a?"bg-primary":"bg-muted"}`},s))})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[e.jsx("div",{className:"px-6 pt-6",children:e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-muted/30 rounded-xl border border-border/50",children:[n.nft_image&&e.jsx("img",{src:n.nft_image,alt:n.nft_name,className:"w-16 h-16 rounded-xl object-cover border border-border/50 shadow-sm flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-base font-semibold text-foreground truncate",children:n.nft_name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs(X,{variant:"secondary",className:"text-xs font-normal bg-background border-border/50",children:[n.total_price," ETH"]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["#",n.order_number]})]})]})]})}),a===1&&e.jsxs("div",{className:"px-6 py-6 space-y-6 animate-in slide-in-from-right-4 duration-300",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-1",children:"Partner's Payment Details"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter the destination details for this transfer."})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"partner-address",className:"text-sm font-medium",children:["NFT Payment Address ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(L,{id:"partner-address",placeholder:"0x...",value:f,onChange:s=>I(s.target.value),className:"h-11 font-mono text-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"partner-method",className:"text-sm font-medium",children:["Payment Method ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{id:"partner-method",value:g,onChange:s=>O(s.target.value),className:"w-full h-11 px-3 rounded-md border border-input bg-background text-sm appearance-none focus:ring-2 focus:ring-primary/20 focus:border-primary transition-all",children:[e.jsx("option",{value:"",children:"Select payment method"}),Q.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-muted-foreground",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"m6 9 6 6 6-6"})})})]})]})]})]}),a===2&&e.jsxs("div",{className:"px-6 py-6 space-y-6 animate-in slide-in-from-right-4 duration-300",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-1",children:"Transfer Details"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Confirm the amount and network for this transaction."})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"your-amount",className:"text-sm font-medium",children:["Amount (ETH) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(L,{id:"your-amount",type:"number",step:"0.01",placeholder:"0.00",value:j,onChange:s=>$(s.target.value),className:"h-11 font-mono text-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"your-network",className:"text-sm font-medium",children:["Network ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{id:"your-network",value:b,onChange:s=>H(s.target.value),className:"w-full h-11 px-3 rounded-md border border-input bg-background text-sm appearance-none focus:ring-2 focus:ring-primary/20 focus:border-primary transition-all",children:[e.jsx("option",{value:"",children:"Select network"}),Ne.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-muted-foreground",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"m6 9 6 6 6-6"})})})]})]})]})]}),a===3&&e.jsxs("div",{className:"px-6 py-8 space-y-6 animate-in slide-in-from-right-4 duration-300",children:[u==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-20 h-20 bg-green-500/10 rounded-full flex items-center justify-center mx-auto ring-8 ring-green-500/5",children:e.jsx(h,{className:"w-10 h-10 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-foreground",children:"Link Generated!"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Waiting for partner to complete payment..."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-5 bg-muted/30 rounded-xl border border-border/50 group relative",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2 uppercase tracking-wider",children:"Transfer Link"}),e.jsx("p",{className:"text-sm font-mono text-foreground break-all pr-8",children:D})]}),e.jsxs(r,{onClick:ce,variant:C?"default":"outline",className:"w-full h-12 gap-2 transition-all duration-300",children:[C?e.jsx(h,{className:"w-5 h-5"}):e.jsx(fe,{className:"w-5 h-5"}),C?"Copied to Clipboard":"Copy Secure Link"]})]}),e.jsxs("div",{className:"bg-blue-500/5 border border-blue-500/10 rounded-xl p-4 flex gap-3 items-start",children:[e.jsx("div",{className:"mt-0.5 text-blue-600",children:e.jsx("div",{className:"animate-pulse w-2 h-2 rounded-full bg-blue-600"})}),e.jsx("p",{className:"text-sm text-blue-600/90 leading-relaxed",children:"Share this link with your partner. This window will update automatically when they complete the payment."})]})]}),u==="payment_completed"&&e.jsxs("div",{className:"space-y-6 animate-in zoom-in-95 duration-300",children:[e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-20 h-20 bg-green-500/10 rounded-full flex items-center justify-center mx-auto ring-8 ring-green-500/5",children:e.jsx(c,{className:"w-10 h-10 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-foreground",children:"Payment Received!"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Partner has marked the payment as completed."})]})]}),e.jsxs("div",{className:"bg-muted/30 rounded-xl border border-border/50 p-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Amount"}),e.jsxs("span",{className:"font-medium",children:[n.total_price," ETH"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Status"}),e.jsxs("span",{className:"text-green-600 font-medium flex items-center gap-1",children:[e.jsx(c,{className:"w-3 h-3"})," Completed"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(r,{onClick:ie,className:"h-12 gap-2",variant:"default",children:[e.jsx(h,{className:"w-5 h-5"}),"Release Now"]}),e.jsxs(r,{type:"button",onClick:s=>{s.preventDefault(),N(!0)},variant:"outline",className:"h-12 gap-2 border-red-200 text-red-600 hover:bg-red-50 hover:text-red-700",children:[e.jsx(z,{className:"w-5 h-5"}),"Appeal"]})]}),ee&&e.jsxs("div",{className:"mt-4 p-5 border border-border rounded-xl bg-card shadow-sm animate-in slide-in-from-top-2 duration-300",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-red-100 dark:bg-red-900/30 rounded-full",children:e.jsx(z,{className:"w-5 h-5 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-foreground",children:"Submit an Appeal"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Please provide details about the issue. Our support team will review your case and mediate the dispute."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"appeal-reason",className:"text-sm font-medium",children:["Reason for Appeal ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(ue,{id:"appeal-reason",autoFocus:!0,value:v,onChange:s=>W(s.target.value),placeholder:"Describe the issue in detail (e.g., payment not received, wrong amount, etc.)...",className:"min-h-[120px] resize-none focus-visible:ring-red-500/20"})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-2",children:[e.jsx(r,{type:"button",variant:"ghost",onClick:()=>N(!1),className:"hover:bg-muted",children:"Cancel"}),e.jsx(r,{type:"button",variant:"destructive",onClick:oe,disabled:!v.trim(),className:"gap-2 shadow-sm",children:"Submit Appeal"})]})]})]})]}),u==="released"&&e.jsxs("div",{className:"text-center space-y-4 animate-in zoom-in-95 duration-300",children:[e.jsx("div",{className:"w-20 h-20 bg-green-500/10 rounded-full flex items-center justify-center mx-auto ring-8 ring-green-500/5",children:e.jsx(c,{className:"w-10 h-10 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-foreground",children:"Transfer Complete!"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Asset has been released to the partner."})]}),e.jsx(r,{onClick:A,className:"w-full",children:"Close"})]})]})]}),e.jsxs("div",{className:"border-t border-border px-6 py-5 bg-muted/30 flex gap-3 sticky bottom-0",children:[a>1&&a<3&&e.jsxs(r,{variant:"outline",onClick:()=>x(a-1),className:"h-11 px-6 gap-2 hover:bg-background",children:[e.jsx(ge,{className:"w-4 h-4"}),"Back"]}),a<3?e.jsxs(r,{onClick:de,disabled:a===1&&(!f||!g)||a===2&&(!j||!b),className:"flex-1 h-11 gap-2 text-base font-medium shadow-lg shadow-primary/20",children:["Next Step",e.jsx(je,{className:"w-4 h-4"})]}):e.jsxs(r,{onClick:()=>ae(n.id),className:"flex-1 h-11 gap-2 text-base font-medium",variant:"default",children:[e.jsx(h,{className:"w-4 h-4"}),"Mark as Sent"]})]})]})}),se&&P&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-md flex items-center justify-center z-50 p-4 animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-background border border-border rounded-2xl shadow-2xl max-w-md w-full overflow-hidden flex flex-col animate-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"border-b border-border px-6 py-5 bg-muted/30 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-foreground tracking-tight",children:"Send NFT"}),e.jsx("button",{onClick:T,className:"h-8 w-8 rounded-full flex items-center justify-center hover:bg-muted transition-colors text-muted-foreground hover:text-foreground",children:e.jsx(o,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-6",children:te?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 space-y-6 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border-4 border-primary/20 animate-spin border-t-primary"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(J,{className:"w-8 h-8 text-primary animate-pulse"})})]}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Verifying Blockchain Network..."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Please wait while we verify your transaction details."})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"manual-address",children:"Your NFT Address"}),e.jsx(L,{id:"manual-address",placeholder:"Enter your wallet address",value:y,onChange:s=>F(s.target.value),className:"h-11 font-mono"})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(r,{variant:"outline",onClick:T,className:"flex-1 h-11",children:"Cancel"}),e.jsx(r,{onClick:le,disabled:!y,className:"flex-1 h-11",children:"Send"})]})]})})]})})]})]})}export{Ie as default};
