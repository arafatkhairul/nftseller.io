import{r as t,d as Q,j as e,H as he,L as $,b as k}from"./app-BuO7t050.js";import{B as Z}from"./badge-CX1FzLWM.js";import{B as n}from"./button-CLoTHJno.js";import{I as S}from"./input-D_OMbqhC.js";import{L as i}from"./label-ZOkBLWB2.js";import{T as fe}from"./textarea-Cr4UJTg7.js";import{A as ge}from"./app-layout-SZNpsY9w.js";import{a as m,b as H,F as x,t as Y,u as je,e as _,v as ee,w as be,h as Ne,x as ve}from"./index-B0WUNDkB.js";/* empty css            */import"./index-e0lLMl4R.js";import"./app-shell-yKHYaNoQ.js";import"./index-D1iA0pQZ.js";import"./createLucideIcon-ByzxiWwV.js";import"./index-39uZGfW-.js";import"./Combination-BCtMqTur.js";import"./iconBase-BJXu5dwp.js";import"./dropdown-menu-B7mCmnL2.js";import"./index-lucvfSli.js";const ye=[{title:"My Portfolio",href:"/orders"}],se={pending:{color:"bg-yellow-500/10 text-yellow-700 border-yellow-200",icon:H,label:"Pending"},completed:{color:"bg-green-500/10 text-green-700 border-green-200",icon:x,label:"Completed"},cancelled:{color:"bg-red-500/10 text-red-700 border-red-200",icon:m,label:"Cancelled"},failed:{color:"bg-red-500/10 text-red-700 border-red-200",icon:m,label:"Failed"},sent:{color:"bg-blue-500/10 text-blue-700 border-blue-200",icon:x,label:"Sent"},appealed:{color:"bg-orange-500/10 text-orange-700 border-orange-200",icon:Y,label:"Appealed"},appeal_approved:{color:"bg-green-500/10 text-green-700 border-green-200",icon:x,label:"Approved"},appeal_rejected:{color:"bg-red-900/10 text-red-900 border-red-500/50",icon:m,label:"Restricted"},pending_sent:{color:"bg-purple-500/10 text-purple-700 border-purple-200",icon:H,label:"Pending Verification"},sent_rejected:{color:"bg-red-500/10 text-red-700 border-red-200",icon:m,label:"Sent Rejected"}};function He({orders:u,paymentMethods:te,networks:D}){const[C,V]=t.useState(!1),[l,W]=t.useState(null),[r,o]=t.useState(1),[g,F]=t.useState(""),[j,P]=t.useState(""),[b,A]=t.useState(""),[T,G]=t.useState(""),[p,M]=t.useState(""),[q,L]=t.useState(""),[E,N]=t.useState(!1),[d,z]=t.useState(null),[h,c]=t.useState("pending"),[ae,f]=t.useState(!1),[v,O]=t.useState(""),[re,U]=t.useState(!1),[R,X]=t.useState(null),[y,B]=t.useState(""),[ne,w]=t.useState(!1),J=D.find(s=>s.name===p),le=J?J.currency_symbol:"ETH";t.useEffect(()=>{let s;return C&&d&&r===3&&(s=setInterval(async()=>{try{const a=await Q.get(`/api/p2p-transfer/${d}/status`);a.data.status!==h&&c(a.data.status)}catch(a){console.error("Error polling status:",a)}},2e3)),()=>{s&&clearInterval(s)}},[C,d,r,h]);const de=s=>{if(W(s),V(!0),s.active_p2p_transfer){const a=s.active_p2p_transfer;o(3),F(a.partner_address),P(a.partner_payment_method_id.toString()),A(a.amount),M(a.network),L(a.link),z(a.id),c(a.status),N(!1),f(!1),O("")}else o(1),F(""),P(""),A(s.total_price),G(""),M(""),L(""),N(!1),z(null),c("pending"),f(!1),O("")},K=()=>{V(!1),W(null),o(1)},ie=s=>{X(s),B(""),w(!1),U(!0)},I=()=>{U(!1),X(null),B(""),w(!1)},oe=()=>{!R||!y||(w(!0),setTimeout(()=>{k.post(route("orders.sent-request",R.id),{sender_address:y},{onSuccess:()=>{I()},onError:()=>{w(!1)}})},3e3))},ce=async()=>{if(r===1&&g&&j)o(2);else if(r===2&&b&&p&&l)try{const s=await Q.post("/api/p2p-transfer/create",{order_id:l.id,partner_address:g,partner_payment_method_id:j,amount:b,sender_address:T,network:p});s.data.success&&(L(s.data.link),z(s.data.transfer_id),c("pending"),o(3),k.reload({only:["orders"],preserveState:!0,preserveScroll:!0}))}catch(s){console.error("Error creating P2P transfer:",s)}},me=()=>{d&&k.post(`/p2p-transfer/${d}/release`,{},{onSuccess:()=>{c("released")}})},xe=()=>{!d||!v||k.post(`/p2p-transfer/${d}/appeal`,{reason:v},{onSuccess:()=>{c("appealed"),f(!1)}})},ue=()=>{navigator.clipboard.writeText(q),N(!0),setTimeout(()=>N(!1),2e3)};return e.jsxs(ge,{breadcrumbs:ye,children:[e.jsx(he,{title:"My Portfolio"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-4",children:[e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"My Portfolio"}),u.length>0&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[u.length," NFT",u.length!==1?"s":""]})]}),e.jsx($,{href:"/nft-marketplace",children:e.jsx(n,{size:"sm",variant:"outline",children:"Browse NFTs"})})]}),u.length>0?e.jsx("div",{className:"space-y-2",children:u.map(s=>{const a=se[s.status]||se.pending,pe=a.icon;return e.jsxs("div",{className:`group border border-border bg-card rounded-xl overflow-hidden hover:shadow-lg hover:border-foreground/20 transition-all duration-200 ${s.status==="appeal_rejected"?"opacity-75 grayscale-[0.5]":""}`,children:[e.jsx($,{href:`/orders/${s.id}`,children:e.jsx("div",{className:"cursor-pointer",children:e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[s.nft_image&&e.jsx("div",{className:"relative flex-shrink-0",children:e.jsx("img",{src:s.nft_image,alt:s.nft_name,className:"w-20 h-20 rounded-lg object-cover border border-border"})}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"text-base font-semibold text-foreground truncate mb-1",children:s.nft_name}),e.jsx("p",{className:"text-xs text-muted-foreground font-mono",children:s.order_number})]}),e.jsxs(Z,{className:`${a.color} flex items-center gap-1.5 whitespace-nowrap`,children:[e.jsx(pe,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"text-xs font-medium",children:a.label})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Amount"}),e.jsxs("p",{className:"font-semibold text-foreground",children:[s.total_price," ETH"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Payment"}),e.jsx("p",{className:"font-medium text-foreground capitalize",children:s.payment_method})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(H,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:s.created_at_diff})]})]})]})})})}),(s.status==="completed"||s.status==="appeal_approved")&&e.jsxs("div",{className:"px-4 pb-4 flex gap-2 justify-end border-t border-border pt-3",children:[e.jsxs(n,{size:"sm",variant:"outline",className:"h-8 text-xs gap-1.5 px-3",onClick:()=>de(s),children:[e.jsx(je,{className:"w-3 h-3"}),"P2P Sent"]}),e.jsxs(n,{size:"sm",className:"h-8 text-xs gap-1.5 px-3",onClick:()=>ie(s),children:[e.jsx(_,{className:"w-3 h-3"}),"Sent"]})]})]},s.id)})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx(ee,{className:"w-10 h-10 text-muted-foreground mb-3"}),e.jsx("h3",{className:"font-medium text-foreground mb-1",children:"No orders yet"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"Start exploring to buy your first NFT"}),e.jsx($,{href:"/nft-marketplace",children:e.jsx(n,{size:"sm",children:"Browse NFTs"})})]}),C&&l&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-md flex items-center justify-center z-50 p-4 animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-background border border-border rounded-2xl shadow-2xl max-w-lg w-full max-h-[90vh] overflow-hidden flex flex-col animate-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"border-b border-border px-6 py-5 bg-muted/30",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-foreground tracking-tight",children:"P2P Send NFT"}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1 font-medium uppercase tracking-wider",children:["Step ",r," of 3"]})]}),e.jsx("button",{onClick:K,className:"h-8 w-8 rounded-full flex items-center justify-center hover:bg-muted transition-colors text-muted-foreground hover:text-foreground",children:e.jsx(m,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"mt-5 flex gap-2",children:[1,2,3].map(s=>e.jsx("div",{className:`h-1.5 flex-1 rounded-full transition-all duration-500 ${s<=r?"bg-primary":"bg-muted"}`},s))})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[e.jsx("div",{className:"px-6 pt-6",children:e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-muted/30 rounded-xl border border-border/50",children:[l.nft_image&&e.jsx("img",{src:l.nft_image,alt:l.nft_name,className:"w-16 h-16 rounded-xl object-cover border border-border/50 shadow-sm flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-base font-semibold text-foreground truncate",children:l.nft_name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs(Z,{variant:"secondary",className:"text-xs font-normal bg-background border-border/50",children:[l.total_price," ETH"]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["#",l.order_number]})]})]})]})}),r===1&&e.jsxs("div",{className:"px-6 py-6 space-y-6 animate-in slide-in-from-right-4 duration-300",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-1",children:"Partner's Payment Details"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter the destination details for this transfer."})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"partner-address",className:"text-sm font-medium",children:["NFT Payment Address ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(S,{id:"partner-address",placeholder:"0x...",value:g,onChange:s=>F(s.target.value),className:"h-11 font-mono text-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"partner-method",className:"text-sm font-medium",children:["Payment Method ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{id:"partner-method",value:j,onChange:s=>P(s.target.value),className:"w-full h-11 px-3 rounded-md border border-input bg-background text-sm appearance-none focus:ring-2 focus:ring-primary/20 focus:border-primary transition-all",children:[e.jsx("option",{value:"",children:"Select payment method"}),te.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-muted-foreground",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"m6 9 6 6 6-6"})})})]})]})]})]}),r===2&&e.jsxs("div",{className:"px-6 py-6 space-y-6 animate-in slide-in-from-right-4 duration-300",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-1",children:"Transfer Details"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Confirm the amount and network for this transaction."})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"your-network",className:"text-sm font-medium",children:["Network ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{id:"your-network",value:p,onChange:s=>M(s.target.value),className:"w-full h-11 px-3 rounded-md border border-input bg-background text-sm appearance-none focus:ring-2 focus:ring-primary/20 focus:border-primary transition-all",children:[e.jsx("option",{value:"",children:"Select network"}),D.map(s=>e.jsx("option",{value:s.name,children:s.name},s.id))]}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-muted-foreground",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"m6 9 6 6 6-6"})})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"your-amount",className:"text-sm font-medium",children:["Amount (",le,") ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(S,{id:"your-amount",type:"number",step:"0.01",placeholder:"0.00",value:b,onChange:s=>A(s.target.value),className:"h-11 font-mono text-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"your-address",className:"text-sm font-medium",children:["Your Wallet Address (To Receive Payment) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(S,{id:"your-address",placeholder:"Enter your wallet address",value:T,onChange:s=>G(s.target.value),className:"h-11 font-mono text-sm"})]})]})]}),r===3&&e.jsxs("div",{className:"px-6 py-8 space-y-6 animate-in slide-in-from-right-4 duration-300",children:[h==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-20 h-20 bg-green-500/10 rounded-full flex items-center justify-center mx-auto ring-8 ring-green-500/5",children:e.jsx(_,{className:"w-10 h-10 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-foreground",children:"Link Generated!"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Waiting for partner to complete payment..."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-5 bg-muted/30 rounded-xl border border-border/50 group relative",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2 uppercase tracking-wider",children:"Transfer Link"}),e.jsx("p",{className:"text-sm font-mono text-foreground break-all pr-8",children:q})]}),e.jsxs(n,{onClick:ue,variant:E?"default":"outline",className:"w-full h-12 gap-2 transition-all duration-300",children:[E?e.jsx(_,{className:"w-5 h-5"}):e.jsx(be,{className:"w-5 h-5"}),E?"Copied to Clipboard":"Copy Secure Link"]})]}),e.jsxs("div",{className:"bg-blue-500/5 border border-blue-500/10 rounded-xl p-4 flex gap-3 items-start",children:[e.jsx("div",{className:"mt-0.5 text-blue-600",children:e.jsx("div",{className:"animate-pulse w-2 h-2 rounded-full bg-blue-600"})}),e.jsx("p",{className:"text-sm text-blue-600/90 leading-relaxed",children:"Share this link with your partner. This window will update automatically when they complete the payment."})]})]}),h==="payment_completed"&&e.jsxs("div",{className:"space-y-6 animate-in zoom-in-95 duration-300",children:[e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"w-20 h-20 bg-green-500/10 rounded-full flex items-center justify-center mx-auto ring-8 ring-green-500/5",children:e.jsx(x,{className:"w-10 h-10 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-foreground",children:"Payment Received!"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Partner has marked the payment as completed."})]})]}),e.jsxs("div",{className:"bg-muted/30 rounded-xl border border-border/50 p-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Amount"}),e.jsxs("span",{className:"font-medium",children:[l.total_price," ETH"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Status"}),e.jsxs("span",{className:"text-green-600 font-medium flex items-center gap-1",children:[e.jsx(x,{className:"w-3 h-3"})," Completed"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(n,{onClick:me,className:"h-12 gap-2",variant:"default",children:[e.jsx(_,{className:"w-5 h-5"}),"Release Now"]}),e.jsxs(n,{type:"button",onClick:s=>{s.preventDefault(),f(!0)},variant:"outline",className:"h-12 gap-2 border-red-200 text-red-600 hover:bg-red-50 hover:text-red-700",children:[e.jsx(Y,{className:"w-5 h-5"}),"Appeal"]})]}),ae&&e.jsxs("div",{className:"mt-4 p-5 border border-border rounded-xl bg-card shadow-sm animate-in slide-in-from-top-2 duration-300",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-red-100 dark:bg-red-900/30 rounded-full",children:e.jsx(Y,{className:"w-5 h-5 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-foreground",children:"Submit an Appeal"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Please provide details about the issue. Our support team will review your case and mediate the dispute."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"appeal-reason",className:"text-sm font-medium",children:["Reason for Appeal ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(fe,{id:"appeal-reason",autoFocus:!0,value:v,onChange:s=>O(s.target.value),placeholder:"Describe the issue in detail (e.g., payment not received, wrong amount, etc.)...",className:"min-h-[120px] resize-none focus-visible:ring-red-500/20"})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-2",children:[e.jsx(n,{type:"button",variant:"ghost",onClick:()=>f(!1),className:"hover:bg-muted",children:"Cancel"}),e.jsx(n,{type:"button",variant:"destructive",onClick:xe,disabled:!v.trim(),className:"gap-2 shadow-sm",children:"Submit Appeal"})]})]})]})]}),h==="released"&&e.jsxs("div",{className:"text-center space-y-4 animate-in zoom-in-95 duration-300",children:[e.jsx("div",{className:"w-20 h-20 bg-green-500/10 rounded-full flex items-center justify-center mx-auto ring-8 ring-green-500/5",children:e.jsx(x,{className:"w-10 h-10 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-foreground",children:"Transfer Complete!"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Asset has been released to the partner."})]}),e.jsx(n,{onClick:K,className:"w-full",children:"Close"})]})]})]}),r<3&&e.jsxs("div",{className:"border-t border-border px-6 py-5 bg-muted/30 flex gap-3 sticky bottom-0",children:[r>1&&e.jsxs(n,{variant:"outline",onClick:()=>o(r-1),className:"h-11 px-6 gap-2 hover:bg-background",children:[e.jsx(Ne,{className:"w-4 h-4"}),"Back"]}),e.jsxs(n,{onClick:ce,disabled:r===1&&(!g||!j)||r===2&&(!b||!p||!T),className:"flex-1 h-11 gap-2 text-base font-medium shadow-lg shadow-primary/20",children:["Next Step",e.jsx(ve,{className:"w-4 h-4"})]})]})]})}),re&&R&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-md flex items-center justify-center z-50 p-4 animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-background border border-border rounded-2xl shadow-2xl max-w-md w-full overflow-hidden flex flex-col animate-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"border-b border-border px-6 py-5 bg-muted/30 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-foreground tracking-tight",children:"Send NFT"}),e.jsx("button",{onClick:I,className:"h-8 w-8 rounded-full flex items-center justify-center hover:bg-muted transition-colors text-muted-foreground hover:text-foreground",children:e.jsx(m,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-6",children:ne?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 space-y-6 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-20 h-20 rounded-full border-4 border-primary/20 animate-spin border-t-primary"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(ee,{className:"w-8 h-8 text-primary animate-pulse"})})]}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Verifying Blockchain Network..."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Please wait while we verify your transaction details."})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"manual-address",children:"Your NFT Address"}),e.jsx(S,{id:"manual-address",placeholder:"Enter your wallet address",value:y,onChange:s=>B(s.target.value),className:"h-11 font-mono"})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(n,{variant:"outline",onClick:I,className:"flex-1 h-11",children:"Cancel"}),e.jsx(n,{onClick:oe,disabled:!y,className:"flex-1 h-11",children:"Send"})]})]})})]})})]})]})}export{He as default};
